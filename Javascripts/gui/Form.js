(function(a){a.guiForm=function(c,k,i){var j,f,d,b;j=a(c);d={errorClass:"error",updatedClass:"updated",dataType:"json",onsuccess:function(){},onerror:function(){}};b=a.extend(d,i);f=a(k);b.beforeSubmit=g;b.success=h;j.ajaxForm(b);function e(n){var m=[];var l=0;a.each(n,function(p,o){if(a(o.data).length){p=o.data.form-p||p}a(c).find("#"+p).addClass("field_error");m[l]=""+o.message+"";l++});return m.join("<br />")}function h(l){f.removeClass("updated error");if(l.status==0){var m=b.onerror(l);if(m==false){f.hide("fast");return}var n="";if(a(l.errors).length){n=e(l.errors);f.addClass("error").html("<p>"+n+"</p>").show("fast")}else{f.hide("fast")}}else{var m=b.onsuccess(l);if(m==false){f.hide("fast");return}if(l.msg!==""){f.addClass("updated").html("<p>"+l.msg+"</p>").show("fast")}else{f.hide("fast")}}if(l.redirect_to){if(l.redirect_timeout){setTimeout("location.replace('"+l.redirect_to+"')",l.redirect_timeout)}else{location.replace(l.redirect_to)}}}function g(){f.removeClass("error").addClass("updated").html("<p>En cours ...</p>").show("fast")}};a.fn.guiForm=function(b,c){c=c||{};this.each(function(){new a.guiForm(this,b,c)});return this}})(jQuery);